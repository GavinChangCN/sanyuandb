<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace必须指向Dao接口 -->
<mapper namespace="com.gavin.springmvcdemo.dao.IProductsDao">

    <select id="getRowCount" resultType="Integer">
        select count(*) from products
        <where>
            <if test="mid == 0">
                1=1
            </if>
            <if test="mid > 0">
                mid=#{mid}
            </if>
        </where>
    </select>

    <select id="selectByParams" resultType="com.gavin.springmvcdemo.model.Products" parameterType="map">
        select * from products
        order by createtime desc
        limit ${offset}, ${size}
    </select>

    <select id="selectByMid" resultType="com.gavin.springmvcdemo.model.Products" parameterType="map">
        SELECT * from products
        <where>
            <if test="mid == 0">
                1=1
            </if>
            <if test="mid > 0">
                mid=#{mid}
            </if>
        </where>
        ORDER BY createtime DESC
        limit ${offset}, ${size}
    </select>

    <insert id="insertProduct" statementType="PREPARED"
            keyProperty="id" useGeneratedKeys="true">
        <selectKey resultType="int" keyProperty="id" order="BEFORE">
            SELECT LAST_INSERT_ID()
        </selectKey>
        INSERT INTO
          products(mid, pdesc, icon, pic, video, `createtime`)
        VALUES (
         ${products.mid},
         ${products.pdesc},
         ${products.icon},
         ${products.pic},
         ${products.video},
         ${products.createtime}
        )
    </insert>

</mapper>
